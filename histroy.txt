
source 8080.sh
apt install -y libnuma-dev libssl-dev libpcre3 libpcre3-dev zlib1g-dev gdb

# ifconfig -a
ifconfig eth1  192.168.0.121 netmask 255.255.255.0 up


cd /root/f-stack-1.12/dpdk/usertools
export EXTRA_CFLAGS='-O0 -g'

./dpdk-setup.sh # compile with x86_64-native-linuxapp-gcc[14][17]



echo 2048 > /sys/devices/system/node/node0/hugepages/hugepages-2048kB/nr_hugepages
echo 2048 > /sys/devices/system/node/node1/hugepages/hugepages-2048kB/nr_hugepages

echo 0 > /sys/devices/system/node/node0/hugepages/hugepages-1048576kB/nr_hugepages
echo 0 > /sys/devices/system/node/node1/hugepages/hugepages-1048576kB/nr_hugepages

cat /sys/devices/system/node/node0/hugepages/hugepages-2048kB/nr_hugepages
cat /sys/devices/system/node/node1/hugepages/hugepages-2048kB/nr_hugepages

cat /sys/devices/system/node/node0/hugepages/hugepages-1048576kB/nr_hugepages
cat /sys/devices/system/node/node1/hugepages/hugepages-1048576kB/nr_hugepages

mkdir /mnt/huge
mount -t hugetlbfs nodev /mnt/huge

echo 0 > /proc/sys/kernel/randomize_va_space
cat /proc/sys/kernel/randomize_va_space

modprobe uio
insmod /root/f-stack-1.12/dpdk/x86_64-native-linuxapp-gcc/kmod/igb_uio.ko
insmod /root/f-stack-1.12/dpdk/x86_64-native-linuxapp-gcc/kmod/rte_kni.ko

cd /root/f-stack-1.12/dpdk/usertools
python dpdk-devbind.py --status
ifconfig ens192 down
python dpdk-devbind.py --bind=igb_uio ens192

export FF_PATH=/root/f-stack-1.12
export FF_DPDK=/root/f-stack-1.12/dpdk/x86_64-native-linuxapp-gcc
cd ../../lib/
make clean; make -j


cd /root/f-stack-1.12/app/nginx-1.11.10
./configure --prefix=/usr/local/nginx_fstack --with-ff_module
make clean; make -j; make install
cd ../..
/usr/local/nginx_fstack/sbin/nginx



cd /root/f-stack-1.12/app/redis-3.2.8/
make clean; make -j;make install
cd ../..
redis-server --conf config.ini --proc-type=primary --proc-id=0  redis.conf




cd /root/f-stack-1.12/example
make; 




./example/helloworld_epoll --conf config.ini --proc-type=primary   --proc-id=0 port 80
./example/helloworld_epoll --conf config.ini --proc-type=secondary --proc-id=1 port 81





cd example; make ; cd -

./helloworld_epoll --conf config.ini --proc-type=primary   --proc-id=0 port 80
./helloworld_epoll --conf config.ini --proc-type=secondary --proc-id=1 port 81




unset http_proxy; unset HTTPS_PROXY ; unset https_proxy; unset HTTP_PROXY